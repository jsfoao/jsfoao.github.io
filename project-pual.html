<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio</title>
    <script></script>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <img class="bg-image" src="assets/img/tram_bg.jpg" alt="">
    <img class="bg-overlay" src="assets/img/BG_Rectangles.png" alt="">
    <div class="wrapper">
        <a class="return-top" onclick="topFunction()">
            <img src="assets/icons/return-top-icon-2.png" alt="" style="height: 45px;" class="return-icon">
        </a>
        <!-- Nav bar-->
        <div class="header" style="margin-bottom: 2rem;">
            <a class="header-logo" href="index.html">
                <div class="title">
                    João Freire
                </div>
                <div class="subtitle">
                    Programmer
                    <div class="title-line"></div>
                </div>
            </a>
            <ul class="menu">
                <li>
                    <a class="menu-button" href="projects.html">
                        <div class="content">Portfolio</div>
                    </a>
                </li>
                <li>
                    <a class="menu-button" href="index.html#about">
                        <div class="content">About</div>
                    </a>
                </li>
                <li>
                    <a class="menu-button" href="https://github.com/jsfoao" target="_blank">
                        <div class="image">
                            <img src="assets/icons/github_logo.png" style="height: 100%;" alt="">
                        </div>
                    </a>
                </li>
                <li>
                    <a class="menu-button" href="https://www.linkedin.com/in/joao-saraivafreire/" target="_blank">
                        <div class="image">
                            <img src="assets/icons/linkedin_logo.png" style="height: 100%;" alt="">
                        </div>
                    </a>
                </li>
                <li>
                    <a class="menu-button" href="https://jwow.itch.io/" target="_blank">
                        <div class="image">
                            <img src="assets/icons/itch-icon.png" style="height: 100%;" alt="">
                        </div>
                    </a>
                </li>
            </ul>
        </div>

        <!-- CONTENT-->
        <a href="projects.html" class="back-button">
            <img src="assets/icons/back-arrow-icon.png" alt="" class="arrow-icon-back">
            Back
        </a>
        <div class="project-title-card">
            <div class="gradient-overlay" style="opacity: 0.8"></div>
            <img class="project-title-img" src="assets/img/projects/pual/PUAL_Marketing.png" alt="" style="bottom: -50%;">
            <div class="project-title-wrapper">
                <div class="project-title">
                    Pack Up And Leaf
                </div>
                <div class="category-nav-wrapper">
                    <ul class="category-list">
                        <li><div class="card-category">Game</div></li>
                        <li><div class="card-category">Unity</div></li>
                    </ul>
                    <ul class="project-menu">
                        <li>
                            <a class="menu-button" href="https://github.com/jsfoao/PackUpAndLeaf/archive/refs/heads/main.zip">
                                <div style="display: flex; flex-direction: row; flex-wrap: nowrap; justify-content: center; min-width: 115px; transform: translateX(3px) translateY(3px);">
                                    <div class="image">
                                        <img src="assets/icons/arrow-down.png" style="height:16px; transform: translateY(3px) translateX(-2px);" alt="">
                                    </div>
                                    <div class="content" style="font-size: medium;">
                                        Latest Build
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a class="menu-button" href="https://github.com/jsfoao/PackUpAndLeaf" target="_blank">
                                <div class="image">
                                    <img src="assets/icons/github_logo.png" style="height: 120%;" alt="">
                                </div>
                            </a>
                        </li>
                        <li>
                            <a class="menu-button" href="https://futuregames.itch.io/packup-and-leaf" target="_blank">
                                <div class="image">
                                    <img src="assets/icons/itch-icon.png" style="height: 120%;" alt="">
                                </div>
                            </a>
                        </li>
                    </ul>   
                </div>
            </div>
        </div>
        <div class="project-category-wrapper">
            <div class="flex-column" style="gap: 2rem; margin-top: rem; margin-bottom: 2rem;">
                <iframe width="100%" height="315" src="https://www.youtube.com/embed/mP8MEGhTQcY" style="margin-right: 2rem;" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                <div style="max-width: 250px;">
                    <div class="category-title-big">
                        Info
                    </div>
                    <p class="content-paragraph">
                        <span class="content-paragraph" style="font-family: Poppins SemiBold;">
                            Role:</span> 
                            Gameplay Programmer & VFX
                    </p>
                    <p class="content-paragraph">
                        <span class="content-paragraph" style="font-family: Poppins SemiBold;">
                            Genre:</span> 
                            3D Platformer
                    </p>
                    <p class="content-paragraph">
                        <span class="content-paragraph" style="font-family: Poppins SemiBold;">
                            Engine:</span> 
                            Unity
                    </p>
                    <p class="content-paragraph">
                        <span class="content-paragraph" style="font-family: Poppins SemiBold;">
                            Team Size:</span> 
                            13
                    </p>
                    <p class="content-paragraph">
                        <span class="content-paragraph" style="font-family: Poppins SemiBold;">
                            Platform:</span> 
                            PC
                    </p>
                    <p class="content-paragraph">
                        <span class="content-paragraph" style="font-family: Poppins SemiBold;">
                            Build Date:</span> 
                            20/20/2020
                    </p>
                </div>
            </div>
            <div>
                <div class="category-title-big">
                    About
                </div>
                <p class="content-paragraph">
                    Pack Up & Leaf is a 3D Adventure Platformer game inspired by old classics like Spyro and Banjo Kazooie.
                    Being a platformer and having a broad target audience, the game heavily depends on how the player's controls feel and how easy they are to pick up.
                    That's the challenge we took which required extensive testing and tweaking.
                </p>
                <div class="category-title-small">
                    What I worked on
                </div>
                <div class="flex-column">
                    <ul class="bullet-point">
                        <li class="bullet-li">
                            Third person camera controller that can orbit or follow and rotate towards a target if there's no player input.
                            It also will react to collision and occlusion as expected and adjust its distance to the target accordingly.
                            Camera also has a free move zone as seen in many AAA games.
                        </li>
                        <li class="bullet-li">
                            Camera management system to easily possess and control other cameras during runtime. Used mostly for switching cameras to play cutscenes.
                        </li>
                        <li class="bullet-li">
                            Interactable objects that will trigger different events when interacted with.
                        </li>
                        <li class="bullet-li">
                            Enemies that will shoot when target is visible and in range.    
                        </li>
                        <li class="bullet-li">
                            Simple shaders and VFX.    
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="project-category-wrapper">
            <div class="category-title-big">
                Third Person Camera
            </div>
            <p class="content-paragraph">
                Since platformers depend so much on how the movement and camera feels, I took the latter as my main focus for this
                project. I had to work very closely with the programmer that was working on the player’s movement to make sure that both
                components fit seamlessly. There’s also a lot of dependencies between camera and movement so we had to plan ahead
                to make sure the needed properties were easily accessible across components. 
            </p>
            <div class="category-title-small">
                Orbit Camera
            </div>
            <div class="flex-column">
                <p class="content-paragraph">
                    The player can move the camera freely around the target in a sphere with radius. The vertical angle is constrained as expected. 
                    The euler angles are also looped so that when the angle reaches 360, it starts back at 0.
                </p>
                <img src="assets/img/projects/pual/OrbitCam.gif" alt="" class="img-wrapper">
            </div>
            <table>
                <tr>
                    <th>Property:</th>
                    <th>Function:</th>
                </tr>
                <tr>
                    <td>Target</td>
                    <td>Target's Transform component</td>
                </tr>
                <tr>
                    <td>Radius</td>
                    <td>Orbit sphere radius</td>
                </tr>
                <tr>
                    <td>Orbit Angles</td>
                    <td>Yaw and Pitch</td>
                </tr>
                <tr>
                    <td>Angle Constraints</td>
                    <td>Min. and max. pitch angles</td>
                </tr>
            </table>
            <div class="expandable-button">
                <a style="display: flex; align-items: center; cursor: pointer;" onclick="OnClick(this)">
                    <div class="expandable-title">Code - Orbit Camera</div>
                    <img src="assets/icons/front-arrow-icon.png" alt="" class="expandable-arrow">
                </a>
                <div class="expandable-content" style="height: 0px;">
                    <!-- HTML generated using hilite.me --><div class="code-snippet" style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">private</span> <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">ExecuteOrbit</span><span style="color: #f8f8f2">()</span>
<span style="color: #f8f8f2">{</span>
    <span style="color: #f8f8f2">ConstrainAngles();</span>
    <span style="color: #f8f8f2">LoopAngle();</span>
    <span style="color: #f8f8f2">Quaternion</span> <span style="color: #f8f8f2">newRotation</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Quaternion.Euler(</span><span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">Vector3(orbitAngles.y,</span> <span style="color: #f8f8f2">orbitAngles.x,</span> <span style="color: #ae81ff">0f</span><span style="color: #f8f8f2">));</span>
    <span style="color: #f8f8f2">_lookRotation</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">newRotation;</span>
    
    <span style="color: #75715e">// looking at target</span>
    <span style="color: #f8f8f2">Vector3</span> <span style="color: #f8f8f2">lookDirection</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">_lookRotation</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">Vector3.forward;</span>
    <span style="color: #f8f8f2">Vector3</span> <span style="color: #f8f8f2">lookPosition</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">_focusPoint</span> <span style="color: #f8f8f2">-</span> <span style="color: #f8f8f2">lookDirection</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">currentRadius;</span>
    
    <span style="color: #75715e">// set pos and rotation</span>
    <span style="color: #f8f8f2">transform.SetPositionAndRotation(lookPosition,</span> <span style="color: #f8f8f2">_lookRotation);</span>
<span style="color: #f8f8f2">}</span>
</pre></div>

                </div>
            <div class="category-title-small">
                Follow Camera
            </div>
            <div>
                <p style="margin-bottom: 0;">
                    Camera will smoothly rotate behind the player when outside the free zone area. If the player is facing the camera, then
                    the camera won’t try to rotate behind the player and it will simply follow its position. The camera will also reset to its default position behind the player when there's no input from the player.
                </p>
                <br>
                <p style="margin-top: 0;">
                    Controller support was one of the goals for this game so it was crucial that the camera could follow the player smoothly
                    when there’s no camera input.
                </p>
            </div>
            <div class="flex-column">
                <img src="assets/img/projects/pual/NewCameraRotation.gif" alt="" class="img-wrapper">
                <img src="assets/img/projects/pual/CameraReset.gif" alt="" class="img-wrapper">
                <img src="assets/img/projects/pual/NormalToSupersonic.gif" alt="" class="img-wrapper">
            </div>
            <table>
                <tr>
                    <th>Property:</th>
                    <th>Function:</th>
                </tr>
                <tr>
                    <td>Default Height</td>
                    <td>Pitch angle to default to</td>
                </tr>
                <tr>
                    <td>Facing Angle</td>
                    <td>Angle threshold when target is facing camera</td>
                </tr>
            </table>
            <div class="expandable-button">
                <a style="display: flex; align-items: center; cursor: pointer;" onclick="OnClick(this)">
                    <div class="expandable-title">Code - Follow Camera</div>
                    <img src="assets/icons/front-arrow-icon.png" alt="" class="expandable-arrow">
                </a>
                <div class="expandable-content" style="height: 0px;">
                    <div class="code-snippet" style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">private</span> <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">ExecuteFollow</span><span style="color: #f8f8f2">()</span>
<span style="color: #f8f8f2">{</span>
    <span style="color: #f8f8f2">LoopAngle();</span>
    <span style="color: #f8f8f2">Vector3</span> <span style="color: #f8f8f2">direction</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">target.position</span> <span style="color: #f8f8f2">-</span> <span style="color: #f8f8f2">_focusPoint;</span>
    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(direction.magnitude</span> <span style="color: #f8f8f2">&lt;</span> <span style="color: #ae81ff">0.1f</span><span style="color: #f8f8f2">)</span>
    <span style="color: #f8f8f2">{</span>
        <span style="color: #f8f8f2">transform.rotation</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">transform.localRotation;</span>
        <span style="color: #66d9ef">return</span><span style="color: #f8f8f2">;</span>
    <span style="color: #f8f8f2">}</span>

    <span style="color: #75715e">// Convert angles here</span>

    <span style="color: #75715e">#region Orbit</span>
    <span style="color: #75715e">// speed for when inside and outside free zone area</span>
    <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">speed</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">direction.magnitude</span> <span style="color: #f8f8f2">&lt;</span> <span style="color: #f8f8f2">focusRadius</span> <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">0.01f</span> <span style="color: #f8f8f2">?</span> <span style="color: #ae81ff">0.1f</span> <span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">rotationSpeed;</span>
    
    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(!isFacingCamera)</span>
    <span style="color: #f8f8f2">{</span>
        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(GameManager.Instance.GetPlayerEntity().GetComponent&lt;PlayerManager&gt;().isGrounded)</span>
        <span style="color: #f8f8f2">{</span>
            <span style="color: #f8f8f2">orbitAngles.x</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Mathf.LerpAngle(orbitAngles.x,</span> <span style="color: #f8f8f2">relativeAngle,</span> <span style="color: #f8f8f2">speed</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">Time.unscaledDeltaTime);</span>
        <span style="color: #f8f8f2">}</span>
        <span style="color: #66d9ef">else</span>
        <span style="color: #f8f8f2">{</span>
            <span style="color: #f8f8f2">orbitAngles.x</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Mathf.LerpAngle(orbitAngles.x,</span> <span style="color: #f8f8f2">relativeAngle,</span> <span style="color: #f8f8f2">onAirRotationSpeed</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">Time.unscaledDeltaTime);</span>
        <span style="color: #f8f8f2">}</span>
    <span style="color: #f8f8f2">}</span>

    <span style="color: #f8f8f2">orbitAngles.y</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Mathf.LerpAngle(orbitAngles.y,</span> <span style="color: #f8f8f2">defaultHeight,</span> <span style="color: #f8f8f2">speed</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">Time.unscaledDeltaTime);</span>
    <span style="color: #f8f8f2">Quaternion</span> <span style="color: #f8f8f2">newRotation</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Quaternion.Euler(</span><span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">Vector3(orbitAngles.y,</span> <span style="color: #f8f8f2">orbitAngles.x,</span> <span style="color: #ae81ff">0f</span><span style="color: #f8f8f2">));</span>
    <span style="color: #f8f8f2">_lookRotation</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">newRotation;</span>
    
    <span style="color: #75715e">// looking at target</span>
    <span style="color: #f8f8f2">Vector3</span> <span style="color: #f8f8f2">lookDirection</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">_lookRotation</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">Vector3.forward;</span>
    <span style="color: #f8f8f2">Vector3</span> <span style="color: #f8f8f2">lookPosition</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">_focusPoint</span> <span style="color: #f8f8f2">-</span> <span style="color: #f8f8f2">lookDirection</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">currentRadius;</span>
    
    <span style="color: #75715e">// set pos and rotation</span>
    <span style="color: #f8f8f2">transform.SetPositionAndRotation(lookPosition,</span> <span style="color: #f8f8f2">_lookRotation);</span>
    <span style="color: #75715e">#endregion</span>
<span style="color: #f8f8f2">}</span>
</pre></div>





                </div>
            <div class="category-title-small">
                Free Move Zone
            </div>
            <div class="flex-column">
                <p class="content-paragraph">
                    The free move zone is an area where the player can move with very little to no camera reaction. The camera targets this
                    area which will move towards the player position depending on how far it is from the center. In our case, we’re just
                    using two easing functions to lerp the position depending if you’re inside or outside the zone. </p>
                <img src="assets/img/projects/pual/FreeMoveZone.gif" alt="" class="img-wrapper">
            </div>
            <table>
                <tr>
                    <th>Property:</th>
                    <th>Function:</th>
                </tr>
                <tr>
                    <td>Focus Radius</td>
                    <td>Free move zone radius</td>
                </tr>
                <tr>
                    <td>Focus Centering</td>
                    <td>How fast to center back to target's position</td>
                </tr>
            </table>
            <div class="expandable-button">
                <a style="display: flex; align-items: center; cursor: pointer;" onclick="OnClick(this)">
                    <div class="expandable-title">Code - Updating Focus Point</div>
                    <img src="assets/icons/front-arrow-icon.png" alt="" class="expandable-arrow">
                </a>
                <div class="expandable-content" style="height: 0px;">
                    <div class="code-snippet" style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">private</span> <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">UpdateFocusPoint</span><span style="color: #f8f8f2">()</span>
<span style="color: #f8f8f2">{</span>
    <span style="color: #f8f8f2">Vector3</span> <span style="color: #f8f8f2">targetPoint</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">target.position;</span>
    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(focusRadius</span> <span style="color: #f8f8f2">&gt;</span> <span style="color: #ae81ff">0f</span><span style="color: #f8f8f2">)</span>
    <span style="color: #f8f8f2">{</span>
        <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">distance</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">(targetPoint</span> <span style="color: #f8f8f2">-</span> <span style="color: #f8f8f2">_focusPoint).magnitude;</span>
        <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">t</span> <span style="color: #f8f8f2">=</span> <span style="color: #ae81ff">1f</span><span style="color: #f8f8f2">;</span>
        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(distance</span> <span style="color: #f8f8f2">&gt;</span> <span style="color: #ae81ff">0.001f</span> <span style="color: #f8f8f2">&amp;&amp;</span> <span style="color: #f8f8f2">focusCentering</span> <span style="color: #f8f8f2">&gt;</span> <span style="color: #ae81ff">0f</span><span style="color: #f8f8f2">)</span>
        <span style="color: #f8f8f2">{</span>
            <span style="color: #f8f8f2">t</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Mathf.Pow(</span><span style="color: #ae81ff">1f</span> <span style="color: #f8f8f2">-</span> <span style="color: #f8f8f2">focusCentering,</span> <span style="color: #f8f8f2">Time.unscaledDeltaTime);</span>
        <span style="color: #f8f8f2">}</span>
        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(distance</span> <span style="color: #f8f8f2">&gt;</span> <span style="color: #f8f8f2">focusRadius)</span>
        <span style="color: #f8f8f2">{</span>
            <span style="color: #f8f8f2">t</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Mathf.Min(t,</span> <span style="color: #f8f8f2">focusRadius</span> <span style="color: #f8f8f2">/</span> <span style="color: #f8f8f2">distance);</span>
        <span style="color: #f8f8f2">}</span>
        <span style="color: #f8f8f2">_focusPoint</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Vector3.Lerp(targetPoint,</span> <span style="color: #f8f8f2">_focusPoint,</span> <span style="color: #f8f8f2">t);</span>
    <span style="color: #f8f8f2">}</span>
    <span style="color: #66d9ef">else</span>
    <span style="color: #f8f8f2">{</span>
        <span style="color: #f8f8f2">_focusPoint</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">targetPoint;</span>
    <span style="color: #f8f8f2">}</span>
<span style="color: #f8f8f2">}</span>
</pre></div>
                </div>
            </div>
            <div class="category-title-small">
                Collision Handling
            </div>
                <div>
                    <p style="margin-bottom: 0;">
                        If there’s an object between the target and the camera, the camera will move closer to the target in order to clear it
                        and so it’s not in front anymore. Both collision and occlusion were solved using the following method:
                        <ul class="bullet-point">
                            <li class="bullet-li">
                                5 Raycasts are "shot" from the camera to the target's position: 4 from each corner and 1 from the center.
                            </li>
                            <li class="bullet-li">
                                The shortest distance from the hit points to the target is calculated and the camera radius is set to this value.
                            </li>
                        </ul>
                    </p>    
                </div>
                <div style="margin-top: 1rem;">
                    <div class="flex-column" style="gap: 1rem">
                        <img src="assets/img/projects/pual/camcollision.png" alt="" class="img-wrapper">
                        <img src="assets/img/projects/pual/CameraCollision.gif" alt="" class="img-wrapper">
                    </div>
                </div> 
            </div>     
            <div class="expandable-button">
                <a style="display: flex; align-items: center; cursor: pointer;" onclick="OnClick(this)">
                    <div class="expandable-title">Code - Collision with clip points</div>
                    <img src="assets/icons/front-arrow-icon.png" alt="" class="expandable-arrow">
                </a>
                <div class="expandable-content" style="height: 0px;">
                    <div class="code-snippet" style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(CollisionWithClipPoints(clipPoints,</span> <span style="color: #f8f8f2">_orbitCamera.Target.position))</span>
        <span style="color: #f8f8f2">{</span>
            <span style="color: #75715e">// Shortest collision distance</span>
            <span style="color: #f8f8f2">_minDistance</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">GetShortestDistance(clipPoints,</span> <span style="color: #f8f8f2">_orbitCamera.Target.position);</span>
            <span style="color: #f8f8f2">_minDistance</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Mathf.Clamp(_minDistance,</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">_orbitCamera.Radius);</span>
            <span style="color: #f8f8f2">_orbitCamera.CurrentRadius</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Mathf.SmoothDamp(_orbitCamera.CurrentRadius,</span> <span style="color: #f8f8f2">_minDistance,</span> <span style="color: #66d9ef">ref</span> <span style="color: #f8f8f2">_camVelocity,</span> <span style="color: #f8f8f2">smoothTime);</span>

            <span style="color: #f8f8f2">colliding</span> <span style="color: #f8f8f2">=</span> <span style="color: #66d9ef">true</span><span style="color: #f8f8f2">;</span>
        <span style="color: #f8f8f2">}</span>
        <span style="color: #66d9ef">else</span>
        <span style="color: #f8f8f2">{</span>
            <span style="color: #f8f8f2">_minDistance</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">_orbitCamera.Radius;</span>
            <span style="color: #f8f8f2">_orbitCamera.CurrentRadius</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Mathf.SmoothDamp(_orbitCamera.CurrentRadius,</span> <span style="color: #f8f8f2">_minDistance,</span> <span style="color: #66d9ef">ref</span> <span style="color: #f8f8f2">_camVelocity,</span> <span style="color: #f8f8f2">smoothReset);</span>
            <span style="color: #f8f8f2">colliding</span> <span style="color: #f8f8f2">=</span> <span style="color: #66d9ef">false</span><span style="color: #f8f8f2">;</span>
        <span style="color: #f8f8f2">}</span>
    <span style="color: #f8f8f2">}</span>
</pre></div>

                </div>
            </div>   
        </div> 
        </div>
        <div class="project-category-wrapper">
            <div class="category-title-big">
                Interactions
            </div>
            <div>
                <p style="margin-bottom: 0;">
                    Using events to invoke different interactions depending on the interacted object. This allowed for a very modular and reusable system.
                </p>   
                <p style="margin-bottom: 0;">
                    When interacting with chests, loot will spawn around the object between a range of distance and the instances will never overlap.
                </p>     
            </div>
            <div style="margin-top: 1rem;">
                <div class="flex-column" style="gap: 1rem">
                    <img src="assets/img/projects/pual/LootDroppingAndInteractable.gif" alt="" class="img-wrapper">
                    <img src="assets/img/projects/pual/interact chest.gif" alt="" class="img-wrapper">
                    <img src="assets/img/projects/pual/RandomLoot.gif" alt="" class="img-wrapper">
                </div>
            </div>  
            <div class="expandable-button">
                <a style="display: flex; align-items: center; cursor: pointer;" onclick="OnClick(this)">
                    <div class="expandable-title">Code - Loot dropping</div>
                    <img src="assets/icons/front-arrow-icon.png" alt="" class="expandable-arrow">
                </a>
                <div class="expandable-content" style="height: 0px;">
<div  class="code-snippet" style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">public</span> <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">DropRandom</span><span style="color: #f8f8f2">()</span>
    <span style="color: #f8f8f2">{</span>
        <span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">lootToSpawn</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Random.Range(lootRange.Min,</span> <span style="color: #f8f8f2">lootRange.Max);</span>
        <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">i</span> <span style="color: #f8f8f2">=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span> <span style="color: #f8f8f2">i</span> <span style="color: #f8f8f2">&lt;</span> <span style="color: #f8f8f2">lootToSpawn;</span> <span style="color: #f8f8f2">i++)</span>
        <span style="color: #f8f8f2">{</span>
            <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">size</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Random.Range(distanceRange.Min,</span> <span style="color: #f8f8f2">distanceRange.Max);</span>
            
            <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">angle</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">i</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">(</span><span style="color: #ae81ff">2</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">Mathf.PI</span> <span style="color: #f8f8f2">/</span> <span style="color: #f8f8f2">lootToSpawn);</span>
            <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">xPos</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Mathf.Cos(angle);</span>
            <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">zPos</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Mathf.Sin(angle);</span>
            
            <span style="color: #f8f8f2">Vector3</span> <span style="color: #f8f8f2">position</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">transform.position</span> <span style="color: #f8f8f2">+</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">Vector3(xPos,</span> <span style="color: #ae81ff">0f</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">zPos)</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">size</span> <span style="color: #f8f8f2">+</span> <span style="color: #f8f8f2">Vector3.up</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">spawnOffset;</span>
    
            <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(loots.Length</span> <span style="color: #f8f8f2">==</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span> <span style="color: #66d9ef">return</span><span style="color: #f8f8f2">;</span> <span style="color: #f8f8f2">}</span>
            <span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">index</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">RandomIndex();</span>
            <span style="color: #f8f8f2">GameObject</span> <span style="color: #f8f8f2">instance</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Instantiate(loots[index].Prefab,</span> <span style="color: #f8f8f2">position,</span> <span style="color: #f8f8f2">Quaternion.identity);</span>
        <span style="color: #f8f8f2">}</span>
    <span style="color: #f8f8f2">}</span>
    </pre></div>
    






                </div>
            </div>   
        </div>
        <!-- <div class="project-category-wrapper">
            <div class="category-title-big">
                Miscellaneous
            </div>
            <div style="margin-top: 1rem;">
                <div class="flex-column" style="gap: 1rem">
                    <img src="PUAL_Marketing.png" alt="" class="img-wrapper">
                    <img src="PUAL_Marketing.png" alt="" class="img-wrapper">
                    <img src="PUAL_Marketing.png" alt="" class="img-wrapper">
                </div>
            </div>  
        </div> -->
        <div class="rights-reserved">
            © 2022 João Freire. All rights reserved. 
        </div>
    </div>
    <script>
        function OnClick(element){
            var content = element.parentElement.getElementsByClassName('expandable-content')[0];
            var arrow = element.parentElement.getElementsByClassName("expandable-arrow")[0];
            var snippet = content.getElementsByClassName("code-snippet")[0];
            if (content.style.height === "0px"){
                console.log(parseInt(snippet.clientHeight, 10));
                content.style.height = parseInt(snippet.clientHeight + 20) + "px";
                arrow.style.transform = "translateX(10px) rotate(-90deg)"
            }
            else{
                content.style.height = "0px";
                arrow.style.transform = "translateX(10px) rotate(90deg)"
            }
        }

        //Get the button:
        var button = document.getElementsByClassName("return-top")[0];
        var icon = document.getElementsByClassName("return-icon")[0];
            
        // When the user scrolls down 20px from the top of the document, show the button
        window.onscroll = function() {scrollFunction()};
            
        function scrollFunction() {
            if (document.documentElement.scrollTop > 200) {
                button.style.bottom = "20px";
            } else {
                button.style.bottom = "-50px";
            }
        }
        
        // When the user clicks on the button, scroll to the top of the document
        function topFunction() {
            document.body.scrollTop = 0; // For Safari
            document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
        }
    </script>
</body>
</html>